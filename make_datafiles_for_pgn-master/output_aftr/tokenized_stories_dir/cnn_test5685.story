Several senior Afghan and NATO officials , including U.S. Chairman of the Joint Chiefs of Staff Adm. Mike Mullen , attended the change-of-command ceremony in Kabul .

He inherits a force that is coming under renewed attack just as NATO prepares to begin the first phase of handing over provincial security to Afghan security forces .

Their deaths bring to 34 the number of international troops who have died in Afghanistan in July . .

For his part , Petraeus plans to retire from the Army at the end of August and assume the CIA director 's job September 6 .

Dubbed King David for turning around what seemed like a losing battle as top U.S. commander in Iraq before he went to Afghanistan , Petraeus is considered a top general in his era , with Esquire magazine naming him one of the most influential people of the 21st century .

`` We 've jokingly said that I went to the White House for the monthly National Security Council meeting on Afghanistan and Pakistan with President Obama , and came out with a new job , '' Petraeus said . `` And that 's not far from the truth . ''

The U.S. military is losing the architect of modern-day counterinsurgency operations .

Petraeus wrote his doctorate dissertation on the lessons America learned in Vietnam .

This week , ahead of his departure , Petraeus assessed the results of his strategy in Afghanistan .

`` What we have done is implement the so-called NATO comprehensive approach , a civil-military campaign ... that does indeed embody many of the principles of the counterinsurgency field manual that we developed back in 2006 , and which we employed in Iraq in the surge of 2007-2008 , '' he said in an interview with NATO-TV .

`` I think generally , it has borne fruit . ''

He said it has been a difficult journey , rife with setbacks , but coalition forces have halted the momentum of the Taliban in much of the country and reversed the insurgent hold in restive Helmand province .

CNN 's David Ariosto , Moni Basu and Samson Desta contributed to this report .

@highlight

Allen : `` In the end -- together we will prevail ''

@highlight

Three service members die in an attack in eastern Afghanistan

@highlight

Gen. David Petraeus is retiring from the military to take over the CIA

@highlight

Petraeus was the top U.S. commander in Iraq and later led NATO forces in Afghanistan

